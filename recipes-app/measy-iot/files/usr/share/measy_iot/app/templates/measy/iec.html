{% extends "appbuilder/base.html" %}
{% block page_title %}{{_("IEC61850 Application")}}{% endblock %}
{% block breadcrumb %}
 <!-- Breadcrumb-->
<ol class="breadcrumb" style="margin-bottom:1px; padding: 0.25rem">
          <li class="breadcrumb-item"><a href="/"><i class="fa fa-home"></i> {{_("Home")}}</a></li>
          <li class="breadcrumb-item">
            <a href="#">{{_("Applications")}}</a>
          </li>
          <li class="breadcrumb-item active">{{_("IEC61850 Application")}}</li>
          <!-- Breadcrumb Menu-->
{#          <li class="breadcrumb-menu d-md-down-none">#}
{#            <div class="btn-group" role="group" aria-label="Button group">#}
{#              <a class="btn" href="#">#}
{#                <i class="icon-speech"></i>#}
{#              </a>#}
{#              <a class="btn" href="..">#}
{#                <i class="icon-graph"></i>  Dashboard</a>#}
{#              <a class="btn" href="#">#}
{#                <i class="icon-settings"></i>  Settings</a>#}
{#            </div>#}
{#          </li>#}
        </ol>
{% endblock %}
{% block content %}
    <div class="row">
                            <div class="col-md-12">
                                <!-- BEGIN PORTLET-->
                                <div class="portlet light form-fit card">
                                    <div class="portlet-title card-header">
                                        <div class="caption">
                                            <i class="fa fa-list  font-blue"></i>
                                            <span class="caption-subject font-blue sbold uppercase"> {{ _("ADC") }} </span>
                                        </div>
{#                                        <div class="actions">#}
{#                                            <input type="checkbox" class="make-switch" checked data-on="success" data-on-color="success" data-off-color="warning" data-size="small"> #}
{#                                        </div>#}
                                    </div>


                                <!-- END PORTLET-->
                                 <div class="card-body  text-center portlet-body form">
                                                    <!-- BEGIN FORM-->
                                                    <form action="#" class="form-horizontal">
                                                        <div class="row">
                                                        <div class="col-md-6">
                                                            <div class="form-group row">
                                                                <label class="control-label col-md-2" style="text-align: right"  >{{ _("ADC1") }}</label>
                                                                <div class="col-md-10">
                                                                    <input type="text" id="adc1_value" class="form-control"> </input>
                                                                </div>

                                                            </div>
                                                            <div class="form-group row">
                                                                <label class="control-label col-md-2" style="text-align: right"  >{{ _("ADC2") }}</label>
                                                                <div class="col-md-10">
                                                                    <input type="text" id="adc2_value" class="form-control"> </input>
                                                                </div>

                                                            </div>
                                                            <div class="form-group row">
                                                                <label class="control-label col-md-2" style="text-align: right"  >{{ _("ADC3") }}</label>
                                                                <div class="col-md-10">
                                                                    <input type="text" id="adc3_value" class="form-control"> </input>
                                                                </div>

                                                            </div>
                                                            <div class="form-group row">
                                                                <label class="control-label col-md-2" style="text-align: right"  >{{ _("ADC4") }}</label>
                                                                <div class="col-md-10">
                                                                    <input type="text" id="adc4_value" class="form-control"> </input>
                                                                </div>

                                                            </div>

{#                                                                <div class="card-footer text-center">#}
{#                                                                <div class="row text-center">#}
                                                                    <div class="text-center">
                                                                        <button type="button" id="adc_update_btn" class="btn btn-primary  btn-sm">
                                                                            <i class="fa fa-refresh"></i> {{ _("UPDATE") }}</button>

{#                                                                        <button type="submit" class="btn btn-primary btn-sm">#}
{#                                                                            <i class="fa fa-send"></i> SEND</button>#}
                                                                    </div>
                                                        </div>
                                                        <div class="alert alert-info col-md-6 text-left" role="alert"><h2>{{ _("Guide") }}:</h2><h5> {{_("Press update to send adc value to IEC clients.")}}</h5></div>
                                                        </div>
                                                    </form>
                                                    <!-- END FORM-->


                             </div>
                            </div>
                        </div>
    </div>
    <div class="row">
                            <div class="col-md-12">
                                <!-- BEGIN LED List-->
                                <div class="card portlet light form-fit">
                                    <div class="card-header portlet-title">
                                        <div class="caption">
                                            <i class="fa  font-blue fa-list "></i><span class="caption-subject font-blue sbold uppercase"> {{ _("LED") }} </span> </div>

                                    </div>
                                    <div class="card-body portlet-body">
                                        <div class="table-scrollable">
                                            <table class="table table-striped table-bordered table-advance table-hover">
                                                <thead>
                                                    <tr>
                                                        <th> # </th>
                                                        <th> {{ _("LED Name") }} </th>
                                                        <th> {{ _("LED Position") }} </th>
                                                        <th> {{ _("LED Status") }} </th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <tr>
                                                        <td class="highlight"> <i class="fa  font-blue fa-lightbulb-o "></i>  LED1  </td>
                                                        <td class="hidden-xs"> heartbeat </td>
                                                        <td> D29 </td>
                                                        <td class="text-center">
                                                         <label class="switch switch-label switch-pill switch-success " style="margin: 0px">
                                                        <input  id="LED2" class="switch-input" type="checkbox" disabled="disabled"/>
                                                        <span id= "span_d2"class="switch-slider" data-checked="{{ _("On") }}" data-unchecked="{{ _("Off") }}"></span>
                                                      </label>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td class="highlight"> <i class="fa  font-blue fa-lightbulb-o "></i>  LED2   </td>
                                                        <td class="hidden-xs"> red </td>
                                                        <td> D28 </td>
                                                        <td class="text-center">
                                                         <label class="switch switch-label switch-pill switch-success" style="margin: 0px">
                                                        <input   id="LED12" class="switch-input" type="checkbox" disabled="disabled" />
                                                        <span id="span_d12" class="switch-slider" data-checked="{{ _("On") }}" data-unchecked="{{ _("Off") }}"></span>
                                                      </label>
                                                        </td>
                                                    </tr>

                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                                    </div>

                                </div>
                                <!-- END LED LIST-->
                            </div>
                        </div>
{% endblock %}
{% block add_tail_js %}
    {{ super() }}
    <script>
        function update_adc_element(res){
            document.getElementById("adc1_value").value= res['adc1'];
            document.getElementById("adc2_value").value= res['adc2'];
            document.getElementById("adc3_value").value= res['adc3'];
            document.getElementById("adc4_value").value= res['adc4'];
        }
        function update_led_element(led,statu){

            if (led === "led1") {
                if (statu === "1") {
                    $("#LED2").removeAttr("checked");
                } else {
                    $("#LED2").attr("checked", true);
                }
            }
            if (led === "led2") {
                if (statu === "1") {
                    $("#LED12").removeAttr("checked");
                } else {
                    $("#LED12").attr("checked", true);
                }
            }

        }
        $(document).ready(function() {
            socket.on('connect', function (res) {
                socket.emit("adc_update",{data:"connect"});
                socket.emit("get_led_status",{data:"connect"});
            });
            $("#adc_update_btn").on("click", function(){
                socket.emit("adc_update",{data:"update_click"});
            });
            socket.on('adc_values', function (res) {
                update_adc_element(res);
            });
            socket.on('led_status', function (res) {
                update_led_element('led1',res['led1']);
                update_led_element('led2',res['led2']);
            });
            socket.on('led_signal', function (res) {
                var led_status = res.data.split(" ");
                update_led_element(led_status[0],led_status[1]);

            });
        });
    </script>

{% endblock %}